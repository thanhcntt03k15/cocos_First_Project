{"version":3,"sources":["assets\\Scripts\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\r\n    // Thuộc tính trích dẫn tài nguyên prefab của các ngôi sao\r\n    @property(cc.Prefab)\r\n    starPrefab: cc.Prefab = null;\r\n\r\n    // Tỉ lệ ngẫu nhiên thời gian biến mất của các ngôi sao\r\n    @property\r\n    maxStarDuration: number = 0;\r\n\r\n    @property\r\n    minStarDuration: number = 0;\r\n\r\n    // Node lấy thông tin mặt đất để xác định độ cao của ngôi sao\r\n    @property(cc.Node)\r\n    ground: cc.Node = null;\r\n\r\n    // Node lấy thông tin của người chơi \r\n    @property(cc.Node)\r\n    player: cc.Node = null;\r\n\r\n    groundY: number;\r\n\r\n    // Tham chiếu điểm nhãn\r\n    @property(cc.Label)\r\n    scoreDisplay: cc.Label= null;\r\n\r\n    score: number;\r\n\r\n    timer: number;\r\n\r\n    starDuration: number;\r\n\r\n    @property(cc.AudioClip)\r\n    scoreAudio: cc.AudioClip ;\r\n\r\n    onLoad(){\r\n        // Lấy điểm neo của mặt đất trên trục y\r\n        this.groundY= this.ground.y + this.ground.height/2; \r\n        // Tạo ngôi sao mới\r\n        this.spawnNewStar();\r\n        // Khởi tạo điểm\r\n        this.score = 0;\r\n\r\n        // Khởi tạo thời gian\r\n        this.timer = 0;\r\n        this.starDuration = 0;\r\n\r\n    }\r\n\r\n    spawnNewStar(){\r\n        // tạo node sao mới trong cảnh\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        // đặt node mới vào bên dưới canvas\r\n        this.node.addChild(newStar);\r\n        // Tạo tọa độ ngẫu nhiên cho ngôi sao\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        // lưu tham chiếu của Game object trên tập lệnh Star\r\n        newStar.getComponent('Star').game = this;\r\n\r\n        // làm mới thời gian, chọn ngẫu nhiên một giá trị theo tỉ lệ xuất hiện của sao\r\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    }\r\n\r\n    getNewStarPosition(){\r\n        var rand = 0;\r\n        // theo vị trí trên mặt đất và độ cao khi nhảy của nhân vật, lấy ngẫu nhiên một điểm neo của ngôi sao trên trục y\r\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight +50;\r\n\r\n        // theo chiệu rộng của màn hình lấy ngẫu nhiên điểm neo của ngôi sao trên trục x\r\n        var maxX = this.node.width/2;\r\n        var randX = (Math.random()-0.5) * 2 * maxX;\r\n        \r\n        // Trả lại điểm neo cho ngôi sao\r\n        return cc.v2(randX,randY);\r\n\r\n    }\r\n\r\n    gainScore(){\r\n\r\n        this.score += 1;\r\n\r\n        // cập nhật điểm số cho scoreDisplay Label\r\n        this.scoreDisplay.string = 'Score: ' + this.score;\r\n\r\n        // Bật âm thanh ghi bàn\r\n        cc.audioEngine.playEffect(this.scoreAudio, false);\r\n\r\n    }\r\n    protected update(dt: number): void {\r\n        // cập nhật thời gian sau mỗi frame, khi một ngôi sao mới không được tạo sau khi quá thời lượng\r\n\r\n        // gọi ra hàm thua cuộc của trò chơi\r\n        if (this.timer > this.starDuration){\r\n            this.gameOver;\r\n            return;\r\n        }\r\n        this.timer += dt;\r\n    }\r\n\r\n    gameOver(){\r\n        // Dừng hành động nhảy của nhân vật\r\n        this.player.stopAllActions();\r\n        // khởi động lại cảnh \r\n        cc.director.loadScene('game');\r\n    }\r\n\r\n}\r\n"]}